const{isArray:e}=Array,t=new Map,s=e=>{e.stopImmediatePropagation(),e.preventDefault()},o=e=>e.waitUntil(clients.claim()),n=e=>{const{request:o}=e;"POST"===o.method&&o.url===`${location.href}?sabayon`&&(s(e),e.respondWith(o.json().then((async e=>{const{promise:s,resolve:n}=Promise.withResolvers(),a=e.join(",");t.set(a,n);for(const t of await clients.matchAll())t.postMessage(e);return s.then((e=>new Response(`[${e.join(",")}]`,o.headers)))}))))},a=o=>{const{data:n}=o;if(e(n)&&4===n.length){const[e,a,r,i]=n,l=[e,a,r].join(",");t.has(l)&&(s(o),t.get(l)(i),t.delete(l))}};export{o as activate,n as fetch,a as message};
